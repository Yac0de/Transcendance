groups:
- name: transcendance  # Nom du groupe d'alertes
  rules:  # Liste des règles d'alerte
  - alert: HighRequestLatency  # Nom de l'alerte pour une latence élevée
    expr: rate(http_request_duration_seconds_sum[5m]) / rate(http_request_duration_seconds_count[5m]) > 0.5  # Expression pour calculer la latence
    for: 1m  # Condition pour que l'alerte soit déclenchée pendant 1 minute
    labels:
      severity: warning  # Niveau de gravité de l'alerte
    annotations:
      summary: High request latency  # Résumé de l'alerte
      description: "API request latency is above 500ms"  # Description détaillée de l'alerte

  - alert: HighErrorRate  # Nom de l'alerte pour un taux d'erreur élevé
    expr: rate(http_requests_total{status=~"5.."}[5m]) / rate(http_requests_total[5m]) > 0.01  # Expression pour calculer le taux d'erreur
    for: 1m  # Condition pour que l'alerte soit déclenchée pendant 1 minute
    labels:
      severity: critical  # Niveau de gravité de l'alerte
    annotations:
      summary: High error rate  # Résumé de l'alerte
      description: "Error rate is above 1%"  # Description détaillée de l'alerte
